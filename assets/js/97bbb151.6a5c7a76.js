"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[1311],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>d});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var p=r.createContext({}),l=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=l(e.components);return r.createElement(p.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,p=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=l(n),h=a,d=u["".concat(p,".").concat(h)]||u[h]||m[h]||o;return n?r.createElement(d,i(i({ref:t},c),{},{components:n})):r.createElement(d,i({ref:t},c))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=h;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s[u]="string"==typeof e?e:a,i[1]=s;for(var l=2;l<o;l++)i[l]=n[l];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}h.displayName="MDXCreateElement"},400:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>m,frontMatter:()=>o,metadata:()=>s,toc:()=>l});var r=n(7462),a=(n(7294),n(3905));const o={sidebar_position:5},i="Type Signatures",s={unversionedId:"stream-basics/type_signatures",id:"stream-basics/type_signatures",title:"Type Signatures",description:"In the recent years, Python has been expanding the support for type hints, which helps a lot during development to catch bugs from types that should not be there, and even detecting Nones before they happen.",source:"@site/docs/stream-basics/type_signatures.md",sourceDirName:"stream-basics",slug:"/stream-basics/type_signatures",permalink:"/langstream/docs/stream-basics/type_signatures",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/stream-basics/type_signatures.md",tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"tutorialSidebar",previous:{title:"Composing Streams",permalink:"/langstream/docs/stream-basics/composing_streams"},next:{title:"Error Handling",permalink:"/langstream/docs/stream-basics/error_handling"}},p={},l=[],c={toc:l},u="wrapper";function m(e){let{components:t,...o}=e;return(0,a.kt)(u,(0,r.Z)({},c,o,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"type-signatures"},"Type Signatures"),(0,a.kt)("p",null,"In the recent years, Python has been expanding the support for ",(0,a.kt)("a",{parentName:"p",href:"https://docs.python.org/3/library/typing.html"},"type hints"),", which helps a lot during development to catch bugs from types that should not be there, and even detecting ",(0,a.kt)("inlineCode",{parentName:"p"},"None"),"s before they happen."),(0,a.kt)("p",null,"On quick scripts, notebooks, some web apps and throwaway code types might not be very useful and actually get in the way, however, when you are doing a lot of data piping and connecting many different pieces together, types are extremely useful, to help you save time and patience in debugging why two things are not working well together, and this is exactly what LangStream is about."),(0,a.kt)("p",null,"Because of that, LangStream has a very thorough type annotation, with the goal of making it very reliable for the developer, but it works best when you explicitly declare the input and output types you expect when defining a stream:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'len_stream = Stream[str, int]("LenStream", lambda input: len(input))\n')),(0,a.kt)("p",null,"This stream above for example, just counts the length of a string, so it takes a ",(0,a.kt)("inlineCode",{parentName:"p"},"str")," and return an ",(0,a.kt)("inlineCode",{parentName:"p"},"int"),". The nice side-effect of this is that you can see, at a glance, what goes in and what goes out of the stream, without needing to read it's implementation"),(0,a.kt)("p",null,"Now, Let's say you have this other stream:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'happy_stream = Stream[str, str]("HappyStream", lambda input: input + " :)")\n')),(0,a.kt)("p",null,"If you try to fit the two, it won't work, but instead of knowing that only when you run the code, you can find out instantly, if you use a code editor like VS Code (with PyLance extension for python type checking), it will look like this:"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"vscode showing typecheck error",src:n(3380).Z,width:"1094",height:"331"})),(0,a.kt)("p",null,"It says that ",(0,a.kt)("inlineCode",{parentName:"p"},'"Iterable[int]" is incompatible with "str"'),", right, the first stream produces ",(0,a.kt)("inlineCode",{parentName:"p"},"int"),"s, so let's transform them to string by adding a ",(0,a.kt)("inlineCode",{parentName:"p"},".map(str)"),":"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"vscode showing typecheck error",src:n(5492).Z,width:"1174",height:"328"})),(0,a.kt)("p",null,"It still doesn't typecheck, but now it says that ",(0,a.kt)("inlineCode",{parentName:"p"},'"Iterable[str]" is incompatible with "str"'),", of course, because streams produce a stream of things, not just one thing, and the ",(0,a.kt)("inlineCode",{parentName:"p"},"happy_stream")," expect a single string, so this type error reminded us that we need to use ",(0,a.kt)("inlineCode",{parentName:"p"},"join()")," first:"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"vscode showing no type errors",src:n(2143).Z,width:"1098",height:"326"})),(0,a.kt)("p",null,"Solved, no type errors now, with instant feedback."),(0,a.kt)("p",null,"You don't necessarily need to add the types of your streams in LangStream, it can be inferenced from the lambda or function you pass, however, be aware it may end up being not what you want, for example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'first_item_stream = Stream("FirstItemStream", lambda input: input[0])\n\nawait collect_final_output(first_item_stream([1, 2, 3]))\n#=> [1]\n\nawait collect_final_output(first_item_stream("Foo Bar"))\n#=> ["F"]\n')),(0,a.kt)("p",null,"The first ",(0,a.kt)("inlineCode",{parentName:"p"},"first_item_stream")," was intended to take the first item only from lists, but it also works with strings actually, since ",(0,a.kt)("inlineCode",{parentName:"p"},"[0]")," works on strings. This might not be what you expected at first, and lead to annoying bugs. If, however, you are explicit about your types, then the second call will show a type error, helping you to notice this early on, maybe before you run it:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},'first_item_stream = Stream[List[int], int]("FirstItemStream", lambda input: input[0])\n\nawait collect_final_output(first_item_stream([1, 2, 3]))\n#=> [1]\n\n# highlight-next-line\nawait collect_final_output(first_item_stream("Foo Bar")) # \u274c type error\n#=> ["F"]\n')),(0,a.kt)("p",null,"Now types cannot prevent all errors, some will still happen at runtime. Go to the next page to check out on error handling."))}m.isMDXComponent=!0},3380:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/type-error-1-7cd53ba9d261534182538c3e040075bb.png"},5492:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/type-error-2-ddaa5c2883e52270b4535e9a5cb07fed.png"},2143:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/type-error-3-50ea46087c72a35262a1c60e57281dc9.png"}}]);